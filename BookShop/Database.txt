GO
	USE MASTER 
GO
	DROP DATABASE BOOKSHOP
GO
	CREATE DATABASE BOOKSHOP
GO
	USE BOOKSHOP
GO
	CREATE TABLE NHANVIEN(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		CHUCVU INT, -- 0 : NHÂN VIÊN, 1 : QUẢN TRỊ VIÊN
		NGAYSINH DATETIME,
		GIOITINH INT, -- 0: NU, 1: NAM
		SDT NVARCHAR(MAX) DEFAULT '',
		EMAIL NVARCHAR(MAX) DEFAULT '',
		QUEQUAN NVARCHAR(MAX) DEFAULT '',
		TAIKHOAN NVARCHAR(MAX) NOT NULL,
		MATKHAU NVARCHAR(MAX) NOT NULL
	)
GO
	CREATE TABLE THELOAI(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX)
	)
GO	
	CREATE TABLE NXB(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX)
	)
GO
	CREATE TABLE TACGIA(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		NGAYSINH DATETIME,
		GIOITINH INT, -- 0: NU, 1: NAM
		EMAIL NVARCHAR(MAX) DEFAULT '',
		DIACHI NVARCHAR(MAX) DEFAULT ''
	)
GO
	CREATE TABLE SACH(
		ID INT IDENTITY PRIMARY KEY,
		NXBID INT,
			FOREIGN KEY(NXBID) REFERENCES NXB(ID),
		TACGIAID INT,
			FOREIGN KEY (TACGIAID) REFERENCES TACGIA(ID),
		THELOAIID INT,
			FOREIGN KEY (THELOAIID) REFERENCES THELOAI(ID),
		GIABAN INT,
		NAMXUATBAN INT,
		THONGTINSACH NVARCHAR(MAX) DEFAULT ''
	)
GO
	CREATE TABLE VANPHONGPHAM(
		ID INT IDENTITY PRIMARY KEY,
		TEN NVARCHAR(MAX),
		NHASANXUAT NVARCHAR(MAX),
		GIABAN INT,
		NGAYSANXUAT DATETIME,
		THONGTIN NVARCHAR(MAX) DEFAULT ''
	)
GO
	CREATE TABLE MATHANG(
		ID INT IDENTITY PRIMARY KEY,
		LOAISP INT, -- 0: LA SACH, 1 LA VAN PHONG PHAM
		SACHID INT, -- GIA TRI == NULL KHI KHONG PHAI SACH
			FOREIGN KEY (SACHID) REFERENCES SACH(ID),
		VANPHONGPHAMID INT,
			FOREIGN KEY (VANPHONGPHAMID) REFERENCES VANPHONGPHAM(ID)
	)
GO
	CREATE TABLE PHIEUNHAP(
		ID INT IDENTITY PRIMARY KEY,
		MAPHIEUNHAP NVARCHAR(MAX),
		NHANVIENID INT,
			FOREIGN KEY (NHANVIENID) REFERENCES NHANVIEN(ID),
		NGAY DATETIME,
		TONGTIEN INT
	)
GO
	CREATE TABLE CHITIETNHAP(
		ID INT IDENTITY PRIMARY KEY,
		MATHANGID INT,
			FOREIGN KEY (MATHANGID) REFERENCES MATHANG(ID),
		DONGIA INT,
		SOLUONG INT,
		THANHTIEN INT
	)
GO
	CREATE TABLE HOADONBAN(
		ID INT IDENTITY PRIMARY KEY,
		MAHOADON NVARCHAR(MAX),
		NHANVIENID INT,
			FOREIGN KEY (NHANVIENID) REFERENCES NHANVIEN(ID),
		NGAY DATETIME,
		TONGTIEN INT	
	)
GO
	CREATE TABLE CHITIETHOADON(
		ID INT IDENTITY PRIMARY KEY,
		MATHANGID INT,
			FOREIGN KEY (MATHANGID) REFERENCES MATHANG(ID),
		DONGIA INT,
		SOLUONG INT,
		THANHTIEN INT
	)
GO